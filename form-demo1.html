<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
	<meta name="theme-color" content="#ea6f5a">
	<title>表单提交及序列化</title>
	<link rel="stylesheet" type="text/css" href="style/bootstrap.css">
	<style type="text/css">
		ul{
			list-style:none;
		}
		.list li{
			float: left;
			width: 400px;
			height: 226px;
			display: inline-block;
			border:1px solid #555;
			box-shadow: 3px 8px 5px #aaa;
			overflow: hidden;
		}
		.list li>img{
			text-align: center;
			width: 100%;
		}
	</style>
</head>
<body>
	<div class="container">
		<form action="http://localhost:9000" method="POST" class="form">
			<div class="row">
				<div class="col-md-12">
					<input type="text" name="title" placeholder="请输入标题" class="form-control input-lg "><hr>
				</div>
				<div class="col-md-12">
					<textarea  rows="20" placeholder="写点什么" name="article" class="form-control input-lg"></textarea><br><hr>
				</div>
			</div>
		</form>
	</div>
	<script type="text/javascript" src="js/jquery-3.1.1.js"></script>
	<script type="text/javascript" src="js/bootstrap.js"></script>
	<script type="text/javascript" src="js/serialize.js"></script>
	<script type="text/javascript" src="js/send-message.js"></script>
	<script type="text/javascript">
		var file =document.getElementById("file");
		var list =document.getElementsByClassName("list")[0];
		//在本地预览图片
		file.onchange = function(e){
			var files = this.files
			if(!files.length) return;
			console.log(files)
			console.log(files.length)
			for(var i=0,len = files.length;i < len;i++){
				//创建一个对象URL，指向计算机上该文件对象的路径
				var fileReader = URL.createObjectURL(files[0])
				var li = "<li><img src="+fileReader+"></li>"
				list.innerHTML += li;
				/*
				var fileReader = new FileReader()
				fileReader.readAsDataURL(files[i])
				fileReader.onload = function(fileReader){
					console.log(fileReader)
					var li ="<li><img src="+fileReader.target.result+"></li>"
					list.innerHTML +=li
				}
				*/
			}
		};
		var form = document.forms[0],
		submit = form.elements["submit"],
		query;

		//console.log(submit)
		submit.onclick = function(e){
			e.preventDefault()
			this.disabled = true
			console.log("run")
			query = "?"+serialize(document.forms[0])
			console.log(query)
		};
	</script>
</body>
</html>
